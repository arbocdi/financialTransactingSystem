############################################
# KAFKA CONSUMER (account-events + retry/dlt)
############################################
# Consumer group id
# NOTE: must be the same for main / retry / DLT topics,
# Spring creates retry-topics automatically with the same group
# spring.kafka.consumer.group-id=transfers
# Offset reset policy:
# start reading only new messages if there is no committed offset
spring.kafka.consumer.auto-offset-reset=latest
# Disable auto commit of offsets
# Offsets will be committed by the listener container after successful processing
spring.kafka.consumer.enable-auto-commit=false
# Read only committed records
# Required when using idempotent producer + Kafka transactions
spring.kafka.consumer.isolation-level=read_committed
############################################
# Poll / processing settings
############################################
# Maximum number of records returned per poll()
# Should be tuned carefully so that processing fits into max.poll.interval.ms
spring.kafka.consumer.max-poll-records=200
# Maximum time between poll() calls
# If processing takes longer than this value, the consumer will be considered dead
# and partitions will be reassigned
# (30 minutes â€” safe value for heavy or blocking processing)
spring.kafka.consumer.max-poll-interval-ms=1800000
# Consumer session timeout
# If no heartbeat is received within this time, the consumer is removed from the group
spring.kafka.consumer.session-timeout-ms=15000
# Heartbeat interval
# Should be significantly lower than session-timeout
spring.kafka.consumer.heartbeat-interval-ms=5000
############################################
# Fetch (controls how much data is fetched)
############################################
# Maximum amount of data fetched in a single request (across all partitions)
spring.kafka.consumer.fetch-max-bytes=52428800
# Maximum amount of data fetched per partition
spring.kafka.consumer.max-partition-fetch-bytes=1048576
############################################
# Listener container (offset management by Spring)
############################################
# Offset acknowledgment mode
# RECORD = commit offset after each successfully processed record
# Recommended for retry-topics to avoid reprocessing entire batches
spring.kafka.listener.ack-mode=RECORD
# Number of concurrent threads per listener (for main topic)
# Must be <= number of partitions
# Example: if autoCreateTopics(..., 10, ...) => max concurrency is 10
spring.kafka.listener.concurrency=${partitions.number}
# Do not stop the container immediately on shutdown
# Allows in-flight records to be processed
spring.kafka.listener.immediate-stop=false
############################################
# Error handling / startup behavior
############################################
# Fail application startup if a required topic is missing
# Useful to avoid silent misconfiguration in production
spring.kafka.listener.missing-topics-fatal=true

